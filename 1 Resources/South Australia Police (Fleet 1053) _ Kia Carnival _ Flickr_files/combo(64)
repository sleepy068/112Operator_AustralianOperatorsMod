YUI.add("hermes-template-head-meta",(function(e,n){var a=e.Template.Handlebars.revive({1:function(e,n,a,t,l){return'name="'},3:function(e,n,a,t,l){return'property="'},5:function(e,n,a,t,l){return'description="'+e.escapeExpression(e.lambda(n,n))+'"'},compiler:[8,">= 4.3.0"],main:function(e,n,a,t,l){var r,o,i,m=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,c="function",u=e.escapeExpression,p=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]},d="<meta "+(null!=(r=p(a,"if").call(m,null!=n?p(n,"isName"):n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.program(3,l,0),data:l,loc:{start:{line:1,column:6},end:{line:1,column:51}}}))?r:"")+u(typeof(o=null!=(o=p(a,"metaName")||(null!=n?p(n,"metaName"):n))?o:s)===c?o.call(m,{name:"metaName",hash:{},data:l,loc:{start:{line:1,column:51},end:{line:1,column:63}}}):o)+'" content="'+u((p(a,"renderMetaInfo")||n&&p(n,"renderMetaInfo")||s).call(m,null!=n?p(n,"metaValue"):n,{name:"renderMetaInfo",hash:{},data:l,loc:{start:{line:1,column:74},end:{line:1,column:102}}}))+'" ';return o=null!=(o=p(a,"metaDescription")||(null!=n?p(n,"metaDescription"):n))?o:s,i={name:"metaDescription",hash:{},fn:e.program(5,l,0),inverse:e.noop,data:l,loc:{start:{line:1,column:104},end:{line:1,column:163}}},r=typeof o===c?o.call(m,i):o,p(a,"metaDescription")||(r=e.hooks.blockHelperMissing.call(n,r,i)),null!=r&&(d+=r),d+' data-dynamic="true">\n'},useData:!0}),t={};e.Array.each([],(function(n){var a=e.Template.get("hermes/"+n);a&&(t[n]=a)})),e.Template.register("hermes/head-meta",(function(n,l){return(l=l||{}).partials=l.partials?e.merge(t,l.partials):t,a(n,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-head-link",(function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,o,t){var a,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'id="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"id")||(null!=e?r(e,"id"):e))?a:n.hooks.helperMissing)?a.call(null!=e?e:n.nullContext||{},{name:"id",hash:{},data:t,loc:{start:{line:1,column:20},end:{line:1,column:26}}}):a)+'"'},3:function(n,e,l,o,t){var a,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'rev="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"rev")||(null!=e?r(e,"rev"):e))?a:n.hooks.helperMissing)?a.call(null!=e?e:n.nullContext||{},{name:"rev",hash:{},data:t,loc:{start:{line:1,column:51},end:{line:1,column:58}}}):a)+'"'},5:function(n,e,l,o,t){var a,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'rel="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"rel")||(null!=e?r(e,"rel"):e))?a:n.hooks.helperMissing)?a.call(null!=e?e:n.nullContext||{},{name:"rel",hash:{},data:t,loc:{start:{line:1,column:83},end:{line:1,column:90}}}):a)+'"'},7:function(n,e,l,o,t){var a,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'type="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"type")||(null!=e?r(e,"type"):e))?a:n.hooks.helperMissing)?a.call(null!=e?e:n.nullContext||{},{name:"type",hash:{},data:t,loc:{start:{line:1,column:117},end:{line:1,column:125}}}):a)+'"'},9:function(n,e,l,o,t){var a,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'media="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"media")||(null!=e?r(e,"media"):e))?a:n.hooks.helperMissing)?a.call(null!=e?e:n.nullContext||{},{name:"media",hash:{},data:t,loc:{start:{line:1,column:154},end:{line:1,column:163}}}):a)+'"'},11:function(n,e,l,o,t){var a,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'href="'+n.escapeExpression("function"==typeof(a=null!=(a=r(l,"href")||(null!=e?r(e,"href"):e))?a:n.hooks.helperMissing)?a.call(null!=e?e:n.nullContext||{},{name:"href",hash:{},data:t,loc:{start:{line:1,column:190},end:{line:1,column:198}}}):a)+'"'},13:function(n,e,l,o,t){var a=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'data-dynamic-added-by="'+n.escapeExpression((a(l,"obfuscateInternals")||e&&a(e,"obfuscateInternals")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=e?a(e,"addedBy"):e,{name:"obfuscateInternals",hash:{},data:t,loc:{start:{line:1,column:245},end:{line:1,column:275}}}))+'"'},compiler:[8,">= 4.3.0"],main:function(n,e,l,o,t){var a,r=null!=e?e:n.nullContext||{},u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"<link "+(null!=(a=u(l,"if").call(r,null!=e?u(e,"id"):e,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:6},end:{line:1,column:34}}}))?a:"")+" "+(null!=(a=u(l,"if").call(r,null!=e?u(e,"rev"):e,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:35},end:{line:1,column:66}}}))?a:"")+" "+(null!=(a=u(l,"if").call(r,null!=e?u(e,"rel"):e,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:67},end:{line:1,column:98}}}))?a:"")+" "+(null!=(a=u(l,"if").call(r,null!=e?u(e,"type"):e,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:99},end:{line:1,column:133}}}))?a:"")+" "+(null!=(a=u(l,"if").call(r,null!=e?u(e,"media"):e,{name:"if",hash:{},fn:n.program(9,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:134},end:{line:1,column:171}}}))?a:"")+" "+(null!=(a=u(l,"if").call(r,null!=e?u(e,"href"):e,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:172},end:{line:1,column:206}}}))?a:"")+" "+(null!=(a=u(l,"if").call(r,null!=e?u(e,"addedBy"):e,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:207},end:{line:1,column:283}}}))?a:"")+' data-dynamic="true" />'},useData:!0}),o={};n.Array.each([],(function(e){var l=n.Template.get("hermes/"+e);l&&(o[e]=l)})),n.Template.register("hermes/head-link",(function(e,t){return(t=t||{}).partials=t.partials?n.merge(o,t.partials):o,l(e,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-head-breadcrumb",(function(t,l){var n=t.Template.Handlebars.revive({1:function(t,l,n,e,a){var o,i=null!=l?l:t.nullContext||{},r=t.hooks.helperMissing,s="function",c=t.escapeExpression,p=t.lookupProperty||function(t,l){if(Object.prototype.hasOwnProperty.call(t,l))return t[l]};return'<script type="application/ld+json">\n\t[{\n\t\t"@context": "http://schema.org",\n\t\t"@type": "BreadcrumbList",\n\t\t"itemListElement": [\n\t\t\t{\n\t\t\t\t"@type": "ListItem",\n\t\t\t\t"position": 1,\n\t\t\t\t"item": {\n\t\t\t\t\t"@id": "https://www.flickr.com/photos/'+c(typeof(o=null!=(o=p(n,"pathAliasOrNsid")||(null!=l?p(l,"pathAliasOrNsid"):l))?o:r)===s?o.call(i,{name:"pathAliasOrNsid",hash:{},data:a,loc:{start:{line:11,column:43},end:{line:11,column:62}}}):o)+'",\n\t\t\t\t\t"name": "'+c(typeof(o=null!=(o=p(n,"displayName")||(null!=l?p(l,"displayName"):l))?o:r)===s?o.call(i,{name:"displayName",hash:{},data:a,loc:{start:{line:12,column:14},end:{line:12,column:29}}}):o)+'",\n\t\t\t\t\t"image": "https:'+c(typeof(o=null!=(o=p(n,"avatarUrl")||(null!=l?p(l,"avatarUrl"):l))?o:r)===s?o.call(i,{name:"avatarUrl",hash:{},data:a,loc:{start:{line:13,column:21},end:{line:13,column:34}}}):o)+'"\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\t"@type": "ListItem",\n\t\t\t\t"position": 2,\n\t\t\t\t"item": {\n\t\t\t\t\t"@id": "https://www.flickr.com/photos/'+c(typeof(o=null!=(o=p(n,"pathAliasOrNsid")||(null!=l?p(l,"pathAliasOrNsid"):l))?o:r)===s?o.call(i,{name:"pathAliasOrNsid",hash:{},data:a,loc:{start:{line:19,column:43},end:{line:19,column:62}}}):o)+"/"+c(typeof(o=null!=(o=p(n,"photoId")||(null!=l?p(l,"photoId"):l))?o:r)===s?o.call(i,{name:"photoId",hash:{},data:a,loc:{start:{line:19,column:63},end:{line:19,column:74}}}):o)+'",\n\t\t\t\t\t"name": "'+c(typeof(o=null!=(o=p(n,"title")||(null!=l?p(l,"title"):l))?o:r)===s?o.call(i,{name:"title",hash:{},data:a,loc:{start:{line:20,column:14},end:{line:20,column:23}}}):o)+'",\n\t\t\t\t\t"image": "https:'+c(typeof(o=null!=(o=p(n,"photoPreview")||(null!=l?p(l,"photoPreview"):l))?o:r)===s?o.call(i,{name:"photoPreview",hash:{},data:a,loc:{start:{line:21,column:21},end:{line:21,column:37}}}):o)+'"\n\t\t\t\t}\n\t\t\t}\n\t\t]\n\t},\n\t{\n\t\t"@context": "https://schema.org/",\n\t\t"@type": "ImageObject",\n\t\t"contentUrl": "https:'+c(typeof(o=null!=(o=p(n,"photoPreview")||(null!=l?p(l,"photoPreview"):l))?o:r)===s?o.call(i,{name:"photoPreview",hash:{},data:a,loc:{start:{line:29,column:23},end:{line:29,column:39}}}):o)+'",\n\t\t"license": "'+c(typeof(o=null!=(o=p(n,"licenseUrl")||(null!=l?p(l,"licenseUrl"):l))?o:r)===s?o.call(i,{name:"licenseUrl",hash:{},data:a,loc:{start:{line:30,column:14},end:{line:30,column:28}}}):o)+'",\n\t\t"acquireLicensePage": "https://www.flickr.com/photos/'+c(typeof(o=null!=(o=p(n,"pathAliasOrNsid")||(null!=l?p(l,"pathAliasOrNsid"):l))?o:r)===s?o.call(i,{name:"pathAliasOrNsid",hash:{},data:a,loc:{start:{line:31,column:55},end:{line:31,column:74}}}):o)+"/"+c(typeof(o=null!=(o=p(n,"photoId")||(null!=l?p(l,"photoId"):l))?o:r)===s?o.call(i,{name:"photoId",hash:{},data:a,loc:{start:{line:31,column:75},end:{line:31,column:86}}}):o)+'"\n\t}]\n<\/script>\n'},compiler:[8,">= 4.3.0"],main:function(t,l,n,e,a){var o,i=t.lookupProperty||function(t,l){if(Object.prototype.hasOwnProperty.call(t,l))return t[l]};return null!=(o=i(n,"if").call(null!=l?l:t.nullContext||{},null!=l?i(l,"photoPreview"):l,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:1,column:0},end:{line:34,column:7}}}))?o:""},useData:!0}),e={};t.Array.each([],(function(l){var n=t.Template.get("hermes/"+l);n&&(e[l]=n)})),t.Template.register("hermes/head-breadcrumb",(function(l,a){return(a=a||{}).partials=a.partials?t.merge(e,a.partials):e,n(l,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-head-meta-view",(function(e){var t=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},subviewConfig:{},buildContainer:function(){return this},loadState:function(){var t=this;return e.Promise.all([t.appContext.getModel("photo-head-meta-models",t._params.photoId),t.appContext.getModel("photo-models",t._params.photoId),t.appContext.getModel("photo-privacy-models",t._params.photoId)]).then((function(e){t.set("photo-meta",e[0]),t.set("photo",e[1]),t.set("photo-privacy",e[2])}))},mapLicenseUrl:function(t){return[e.url(this.get("photo").getValue("url")),"https://creativecommons.org/licenses/by-nc-sa/2.0/","https://creativecommons.org/licenses/by-nc/2.0/","https://creativecommons.org/licenses/by-nc-nd/2.0/","https://creativecommons.org/licenses/by/2.0/","https://creativecommons.org/licenses/by-sa/2.0/","https://creativecommons.org/licenses/by-nd/2.0/","/commons/usage/","http://www.usa.gov/copyright.shtml","https://creativecommons.org/publicdomain/zero/1.0/","https://creativecommons.org/publicdomain/mark/1.0/"][t]},buildHeadContainer:function(){var t,a=this.get("photo-meta"),o=this.get("photo"),i=o.getValue("owner"),l=i.getValue("buddyicon"),m=this.get("photo-privacy"),s=e.url(),n=a.getFieldsForDisplay(),r="",p=this,h=[{id:"canonicalurl",rel:"canonical",href:s+o.getValue("url")},{rel:"alternative",type:"application/json+oembed",href:s+"/services/oembed?url="+encodeURI(s+o.getValue("url"))+"&format=json",title:o.getValue("title")},{rel:"alternative",type:"text/xml+oembed",href:s+"/services/oembed?url="+encodeURI(s+o.getValue("url"))+"&format=xml",title:o.getValue("title")}];n["al:ios:url"]||(n["al:ios:url"]="flickr://flickr.com"+o.getValue("url")),r+=this.templates("head-meta")({isName:!0,metaName:"description",metaValue:o.getValue("description")||""})+"\n";var d="noarchive";return m.getValue("isPublic")&&!m.getValue("isHidden")||(d+=", noindex"),r+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:d}),r+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:d}),this.appContext.flipper.isFlipped("enable-responsive-mobile-photo-page")&&(r+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, viewport-fit=cover, initial-scale=1, maximum-scale=1"})),Object.keys(n).forEach((function(e){"object"==typeof n[e]&&"pinterest"===e?r+=p.templates("head-meta")({metaName:e,noPin:!0,metaValue:n[e].nopin,metaDescription:n[e].reason,isName:!0})+"\n":"og:description"===e?r+=p.templates("head-meta")({metaName:e,metaValue:n[e]})+"\n":"og:type"===e?r+=p.templates("head-meta")({metaName:e,metaValue:"article"})+"\n":"title"===e?r+=p.templates("head-meta")({isName:!0,metaName:"title",metaValue:n[e]})+"\n":"keywords"===e?r+=p.templates("head-meta")({isName:!0,metaName:e,metaValue:n[e]})+"\n":"noindexfollow"===e?n[e]&&(n[e]>0||""!==n[e])&&(r+=p.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noindex,follow"})+"\n",r+=p.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noindex,follow"})+"\n"):r+=p.templates("head-meta")({metaName:e,metaValue:n[e]})+"\n"})),h.forEach((function(e){e.addedBy=p.name,r+=p.templates("head-link")(e)+"\n"})),o&&(t=o.getSizeToFit({width:1024,height:1024})),r+=p.templates("head-breadcrumb")({pathAliasOrNsid:i.getValue("pathAlias")||i.getValue("id"),displayName:i.getValue("displayname"),avatarUrl:l.default,photoId:o.getValue("id"),title:o.getValue("title")||this.intlMessage({intlName:"common.UNTITLED"}),photoPreview:t?t.url:null,licenseUrl:this.mapLicenseUrl(o.getValue("license"))}),this.set("headContainer",r),YUI.Env.isServer||this.updateHead(),this}});return e.mix(t.prototype,e.Seo),t}),"@VERSION@",{requires:["flickr-view","hermes-template-head-meta","hermes-template-head-link","hermes-template-head-breadcrumb"],optional:["photo-head-meta-models","photo-route","url","seo"],langBundles:["meta","common","attribution","share-modal"]});YUI.add("hermes-lang-meta",(function(e,l){e.Intl.add("hermes/meta","en-US",{PHOTOSTREAM:[{type:0,value:"Explore "},{type:1,value:"username"},{type:0,value:"’s "},{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"photo on Flickr!"}]},other:{value:[{type:7},{type:0,value:" photos on Flickr!"}]}},offset:0,pluralType:"cardinal"}],PHOTOSTREAM_NO_PHOTOS:[{type:0,value:"Explore "},{type:1,value:"username"},{type:0,value:"’s photos on Flickr!"}],ALBUMS_LIST:[{type:0,value:"Explore "},{type:1,value:"username"},{type:0,value:"’s "},{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"album on Flickr!"}]},other:{value:[{type:7},{type:0,value:" albums on Flickr!"}]}},offset:0,pluralType:"cardinal"}],ALBUMS_LIST_NO_ALBUMS:[{type:0,value:"Explore "},{type:1,value:"username"},{type:0,value:"’s albums on Flickr!"}],FAVORITES:[{type:0,value:"Explore "},{type:1,value:"username"},{type:0,value:"’s "},{type:6,value:"photoCount",options:{one:{value:[{type:0,value:"favorites on Flickr!"}]},other:{value:[{type:7},{type:0,value:" favorites on Flickr!"}]}},offset:0,pluralType:"cardinal"}],FAVORITES_NO_PHOTOS:[{type:0,value:"Explore "},{type:1,value:"username"},{type:0,value:"’s favorites on Flickr!"}],META_DESCRIPTION_BY_USER_ON_FLICKR:[{type:0,value:"By "},{type:1,value:"username"},{type:0,value:" on Flickr"}],PHOTOSTREAM_ATOM_TITLE:[{type:0,value:"Flickr: "},{type:1,value:"username"},{type:0,value:"’s Photostream Atom feed"}],FAVORITES_ATOM_TITLE:[{type:0,value:"Flickr: "},{type:1,value:"username"},{type:0,value:"’s Favorites Atom feed"}],GROUP_POOL_ATOM_TITLE:[{type:0,value:"Flickr: "},{type:1,value:"groupName"},{type:0,value:"’s Photos Atom feed"}],GROUP_DISCUSSIONS_ATOM_TITLE:[{type:0,value:"Flickr: "},{type:1,value:"groupName"},{type:0,value:"’s Discussions Atom feed"}],ALBUM_ATOM_TITLE:[{type:0,value:"Flickr: "},{type:1,value:"username"},{type:0,value:'’s "'},{type:1,value:"albumTitle"},{type:0,value:'" Atom feed'}]})}),"@VERSION@",{requires:["intl"]});YUI.add("photo-page-lightbox-scrappy-view",(function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i=this;return this.backToURL=t.backToURL,this.entryTypeIntlKey=t.entryTypeIntlKey,this.photoId=t.photoId,this.isOwner=t.isOwner,this.context=e.clone(t.context,!0),this.appContext.experiments.fullscreen.enableFullscreen(),t.realFullscreen=!0,t.isOwner=this.isOwner,this.appContext.getViewer().signedIn&&(t.signinPendingQueue=e.SigninHelper.checkPendingQueue(this.appContext)),this.appContext.getModel("photo-models",this.photoId).then((function(t){t.on("valuesChanged",(function(t){t.title&&e.one("head title").set("text",i.intlMessage({intlName:"photo-page-scrappy.PAGE_TITLE",title:t.title.newVal}))}))})),this},subviewConfig:{"photo-well-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["scrappy-photo-page-enabled","is-real-fullscreen","enable-zoom"],dealbreaker:!0},"photo-head-meta-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},buildContainer:function(){var e=this.subviews["photo-well-view"].get("container");return this.setContainerWithTemplate("photo-page-lightbox",{"photo-well-view":e}),this},activate:function(){return this},closeDialog:function(t){e.config.win.location.href=this.backToURL},destructor:function(){clearTimeout(this.scrollTimeout)}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-page-lightbox","signin-helper","url"],optionalRequires:["hermes-core"],optional:["photo-well-view","photo-head-meta-view"],langBundles:["common","photo-page-scrappy"]});YUI.add("photo-well-scrappy-view",(function(e,t){var i=require("hermes-core/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.contextData=e.clone(t.context,!0),this.entryURL=t.backToURL,this.entryTypeIntlKey=t.entryTypeIntlKey,this.isAd=!!t.ad,this.hideBackToLink=t.hideBackToLink||!1,this.publisherUrl=t.publisherUrl,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.numberOfPositionsToPreFetch=t.numberOfPositionsToPreFetch,this.numberOfPositionsToRefetchAt=t.numberOfPositionsToRefetchAt,this},additionalViewClasses:["centered-content"],subviewConfig:{"photo-well-media-scrappy-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-notes-scrappy-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(e){return!this.appContext.flipper.isFlipped("enable-scrappy-notes")||e.ad}},"photo-engagement-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"context-slider-scrappy-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"photo-sidebar-toggle-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,neverShowOnServer:!0},"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["is-real-fullscreen","photo-attribution"]},"people-notes-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:!0}},loadState:function(){var t=this,o=[];return o.push(this.appContext.getModel("photo-models",this.photoId).then((function(e){if(!e)throw new Error("[photo-well-view] Invalid photoModel returned from getModel");t.set("photo",e)}))),this.contextData&&this.contextData.modelName&&this.contextData.params&&o.push(this.appContext.getModelRegistry(this.contextData.modelName).then((function(e){var o;if(e&&(o=e.attributeSearch(t.contextData.params))&&o.length&&e.exists(o[0]))return t.appContext.getModel(t.contextData.modelName,o[0]).then((function(e){e&&t.set("contextModel",e)}),(function(e){return i.error("photo not found in context. Loading photostream instead.",{err:e}),t.loadPhotostreamContext()}))})).catch((function(){return"whatever"}))),e.Promise.all(o)},buildContainer:function(){var e,t,i,o,n,a,r,s,h,l=this,u="",d=0;return this.appContext.experiments.fullscreen.getMode()?this.subviews["attribution-view"]&&(YUI.Env.isServer||this.subviews["attribution-view"].get("container").removeClass("is-always-hidden"),"photoList-models"!==this.contextData.modelName&&"explore-models"!==this.contextData.modelName&&this.subviews["attribution-view"].get("container").addClass("is-hidden"),u=this.subviews["attribution-view"].get("container")):this.subviews["attribution-view"]&&(this.subviews["attribution-view"].get("container").addClass("is-always-hidden"),u=this.subviews["attribution-view"].get("container")),this.get("contextModel")&&this.get("contextModel").getValue("photoContextList")&&(e=this.get("contextModel").getValue("photoContextList").getList()).length>2&&e.some((function(e){return d++,e.getValue("id")===l.photoId}))&&(t=e.slice(d-2,d-1),i=e.slice(d,d+1),t&&t.length>0&&(o=l.setupNavLink(t[0],".navigate-prev","previous"),a=l.setupNavTitle(t[0])),i&&i.length>0&&(n=l.setupNavLink(i[0],".navigate-next","next"),r=l.setupNavTitle(i[0]))),h=(s=this.getPhotoWellHeight())-70,this.setContainerWithTemplate("photo-well-scrappy",{"photo-well-media-view":this.subviews["photo-well-media-scrappy-view"]?this.subviews["photo-well-media-scrappy-view"].get("container"):"","context-slider-view":this.subviews["context-slider-scrappy-view"]?this.subviews["context-slider-scrappy-view"].get("container"):"","is-hidden":!o&&!n,"prev-is-not-clickable":!o,"next-is-not-clickable":!n,"prev-url":o,"next-url":n,"prev-title":a,"next-title":r,"is-ad":this.isAd,"attribution-view":u,height:s,navHeight:h,entryURL:this.entryURL,backToLabel:this.intlMessage({intlName:"photo-page-scrappy."+this.entryTypeIntlKey}),enableZoom:!0,hideBackToLink:this.hideBackToLink}),this.fireSubviewResizeEvents(),YUI.Env.isServer&&(this.serverWidth=this.subviews["photo-well-media-scrappy-view"].serverWidth,this.serverHeight=this.subviews["photo-well-media-scrappy-view"].serverHeight),this},buildHeadContainer:function(){var e=this.templates("photo-page-right-size-express")({photoWidth:this.get("photo").getLargestSize().width,photoHeight:this.get("photo").getLargestSize().height});return this.set("headContainer",e),this},fireSubviewResizeEvents:function(){YUI.Env.isServer||(this.subviews["photo-well-media-scrappy-view"]&&this.subviews["photo-well-media-scrappy-view"].fire("parentViewEvent","photoWellResized"),this.subviews["photo-notes-scrappy-view"]&&this.subviews["photo-notes-scrappy-view"].fire("parentViewEvent","photoWellResized"))},setLinkAsAdFriendly:function(e){var t=e.currentTarget;t.hasClass("navigate-next")?this.appContext.adManager.setAdCouldBeShown(!0,"next",t.getAttribute("href")):this.appContext.adManager.setAdCouldBeShown(!0,"previous",t.getAttribute("href"))},animateNavigation:function(){var t=e.all(".navigate-target"),i=this.get("container"),o=i.one(".photo-sidebar-toggle-view"),n=i.one(".attribution-view"),a=1500,r=!0,s=this;a=(a-500)/2,this.appContext.experiments.fullscreen.getMode(),this.registerEventHandler(this.get("container").on("mousemove",e.betterThrottle((function(e){t&&r&&t.removeClass("is-hidden"),r&&(o&&o.removeClass("is-hidden"),n&&n.removeClass("is-hidden")),clearTimeout(s.movingTimeout),clearTimeout(s.initialTimeout),r=!0,s.movingTimeout=setTimeout((function(){n&&n.addClass("is-hidden")}),2*a)}),250))),"photoList-models"!==this.contextData.modelName&&"explore-models"!==this.contextData.modelName&&(r=!1),s.initialTimeout=setTimeout((function(){(r=!0)&&n&&n.addClass("is-hidden")}),2*a)},activate:function(){var t,o,n,a,r,s=this,h=this.contextData,l=0,u=".navigate-prev",d=".navigate-next",p="right";return YUI.Env.isServer||(o=e.getLocation(),n=o.protocol,a=o.host,s.appContext.getModel(h.modelName,h.params).then((function(e){s.set("contextModel",e)}),(function(t){if(!t.getModelFailure&&1!==t.code||"photostream-models"===h.modelName)throw e.one(u).hide(),e.one(d).hide(),t;return s.contextData.modelName="photostream-models",s.contextData.params.id=s.get("photo").getValue("owner").getValue("nsid"),s.appContext.getModel("photostream-models",s.contextData.params).then((function(e){s.set("contextModel",e)}))})).then((function(){var t,i,o,c,v,g,m=s.get("contextModel").getValue("photoContextList"),w=m.getList();return g=s.appContext.getReferrer(),w.length>2&&w.some((function(e){return l++,e.getValue("id")===s.photoId}))&&(i=w.slice(l-2,l-1),o=w.slice(l,l+1),i&&i.length>0&&(c=s.setupNavLink(i[0],u,"previous"))&&(t=s.get("container").one(u),s.updateNavLinks(t,n,a,c),s.get("container").one(u).removeClass("no-click")),o&&o.length>0&&(v=s.setupNavLink(o[0],d,"next"))&&(t=s.get("container").one(d),s.updateNavLinks(t,n,a,v),s.get("container").one(d).removeClass("no-click"),t.getAttribute("href")&&t.getAttribute("href").indexOf(g)>-1&&(p="left"))),r=e.merge(h.params,{photoId:s.photoId,numNext:s.numberOfPositionsToPreFetch,numPrev:s.numberOfPositionsToPreFetch,refetchAt:s.numberOfPositionsToRefetchAt}),h.ownerId&&(r.ownerId=h.ownerId),m.getContext(r)})).then((function(e){function t(t,i,o){var r,h,l,u,d,p,c=s.get("container").one(t),v=e&&e[i]&&e[i].length;if(c)if(v){if(c.removeClass("no-click"),r=s.setupNavLink(e[i][0],t,i),s.isAd)i===(l=s.appContext.adManager.origin).arrow?(c.setAttribute("href",l.url),c.removeClass("is-hidden")):(c.setAttribute("href",r),c.removeClass("is-hidden"));else if(s.updateNavLinks(c,n,a,r),o)for(h=s.subviews["photo-well-media-scrappy-view"].getCanvasSize(),p=0;p<1&&e[i][p];p++)(u=e[i][p].getSizeToFit(h))&&u.url&&((d=new Image).src=u.url,d.complete&&(d.onloadFired=!0))}else c.remove()}s.appContext.adManager.updateContext({prev:e.previous[0],current:s.get("photo"),next:e.next[0],type:s.contextData.modelName,entryURL:s.entryURL}),t(d,"next","right"===p),t(u,"previous","left"===p),s.animateNavigation(),s.isAd&&s.appContext.adManager.markAdAsSeen()}),(function(e){if(e.notInContext||99===e.code)return s.get("contextModel").setValue("photoContextList",[]),s.contextData.modelName="photostream-models",s.contextData.params.id=s.get("photo").getValue("owner").getValue("nsid"),s.activate();throw e})).then(null,(function(e){i.warn("There was a problem initializing the next/previous controls.",{err:e})})),this.attachKeyEvent("down:37,75,39,74",s.handlePrevNextKeys.bind(s)),this.get("photo").getValue("isOwner")||this.appContext.getViewCounter().queue(this.get("photo").getValue("id"),this.publisherUrl||this.appContext.getReferrer())),t={":ad":s.setLinkAsAdFriendly},this.hideBackToLink||this.attachKeyEvent("down:66",(function(t){t.preventDefault(),e.rapidTracker.beacon(s.name,"backToContextKeyPress"),s.appContext.flapp.hasRoute(s.entryURL)?s.appContext.flapp.navigate(s.entryURL):e.config.win.location.href=s.entryURL})),this.registerEventHandler(e.on("resize",e.betterThrottle((function(e){s.set("canvasSizeIsDirty",!0),s.buildContainer()}),16))),this.fireSubviewResizeEvents(),this.attachEvents(t),this},getPhotoWellHeight:function(){var e,t=this.appContext.viewportData.getWidth(),i=this.appContext.viewportData.getHeight()-50,o=120,n=t/2.3+o,a=t/2.75;return e=i>t/1+o?t/1:i>n?i-o:i>a?i-o+o*(i-n)/(a-n):i,Math.max(500,Math.round(e))},getActualPhotoWellHeight:function(){return this.get("container").one(".height-controller").get("region").height},setupNavLink:function(t,o,n){var a,r,s=this.get("container").one(o);if(!t)return void s.remove();a=t;let h=this.contextData&&this.contextData.params&&this.contextData.params.contextSuffix?this.contextData.params.contextSuffix:this.get("contextModel").getValue("urlSuffix");return(r=e.URLHelper.getPhotoPage({photoId:a.getValue("id"),pathAlias:a.getValue("owner").getValue("pathAlias"),contextSuffix:h}))&&"#"!==r?r:(i.warn("Invalid next/prev URL",{url:r}),void s.remove())},setupNavTitle:function(e){var t;return e.getValue("owner")&&(t=""===e.getValue("title").trim()?this.intlMessage({intlName:"common.UNTITLED"}):e.getValue("title"),t+=" | "+this.intlMessage({intlName:"common.BY_USER",user:e.getValue("owner").getValue("username")})),t},updateNavLinks:function(e,t,i,o){e.setAttribute("href",t+"//"+i+o),e.removeClass("is-hidden")},destructor:function(){clearTimeout(this.movingTimeout),clearTimeout(this.initialTimeout),clearTimeout(this.adTimeout),this.adTimeout=null,this.movingTimeout=null,this.initialTimeout=null},handlePrevNextKeys:function(t){var o,n,a,r=this;this.adNavKeyLock||(37===t.button||75===t.button?(n=".navigate-prev",a="previous",e.rapidTracker.beacon(this.name,"prevPhotoKeyPress")):39!==t.button&&74!==t.button||(n=".navigate-next",a="next",e.rapidTracker.beacon(this.name,"nextPhotoKeyPress")),n&&r.get("container").one(n)&&(t.preventDefault(),(o=r.get("container").one(n).getAttribute("href"))&&"#"!==o&&(r.keyboardNavigation&&r.keyboardNavigation.url&&o===r.keyboardNavigation.url&&(new Date).getTime()-r.keyboardNavigation.time<50?i.log("Ignoring duplicate keyboard navigation",{url:o}):(r.keyboardNavigation={url:o,time:(new Date).getTime()},this.appContext.adManager.setAdCouldBeShown(!0,a,o),r.appContext.flapp.navigate(o)))))},handleContextMenu:function(e){e.preventDefault(),this.fire("parentViewEvent","rightClickPhoto")},onSubviewEvent:function(t,i){if(i&&"photoWellResized"===i[0])this.fire("parentViewEvent","photoWellResized");else if(i&&"adPageTimeoutStart"===i[0]){var o=this.get("container").all(".context-slider"),n=this.get("container").all(".navigate-target");o&&n&&(o.addClass("navad-timer"),n.addClass("navad-timer")),this.adNavKeyLock=!0,this.adCountdown(e.config.flickr.moola.positions.interstitials[0].ad_timer_start_value,o,n)}},adCountdown:function(e,t,i){var o=this,n=this.get("container").one(".navad-timer-text");this.adTimeout=setTimeout((function(){var a=o.intlMessage({intlName:"common.AD_INTERSTITIAL_TIMER",adTimerStartCount:e.toString()});n.set("innerHTML",a),e>=1?(e-=1,o.adCountdown(e,t,i)):(t.removeClass("navad-timer"),i.removeClass("navad-timer"),n.set("innerHTML",""),o.adNavKeyLock=!1,clearTimeout(this.adTimeout))}),1e3)}})}),"@VERSION@",{requires:["yui-throttle","flickr-view","hermes-template-photo-well-scrappy","url-helper","better-throttle","hermes-template-photo-page-right-size-express"],optionalRequires:["hermes-core"],optional:["photo-well-media-scrappy-view","context-slider-scrappy-view","photo-engagement-view","photo-models","photo-route"],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-template-mobile-photo-well",(function(n,e){var t=n.Template.Handlebars.revive({1:function(n,e,t,l,a){var o,i=null!=e?e:n.nullContext||{},s=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t<div class="restricted-interstitial">\n\t\t<div class="restricted-interstitial-message">\n\t\t\t<h2>'+n.escapeExpression((s(t,"intlMessage")||e&&s(e,"intlMessage")||n.hooks.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:a,loc:{start:{line:10,column:7},end:{line:10,column:66}}}))+"</h2>\n"+(null!=(o=s(t,"if").call(i,null!=e?s(e,"isSignedIn"):e,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.program(5,a,0),data:a,loc:{start:{line:11,column:3},end:{line:20,column:10}}}))?o:"")+"\t\t</div>\n\t</div>\n"},2:function(n,e,t,l,a){var o,i=null!=e?e:n.nullContext||{},s=n.hooks.helperMissing,r=n.escapeExpression,c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t\t\t<p>"+r((c(t,"intlMessage")||e&&c(e,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:a,loc:{start:{line:12,column:7},end:{line:12,column:69}}}))+"<br />"+r((c(t,"intlMessage")||e&&c(e,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:a,loc:{start:{line:12,column:75},end:{line:12,column:136}}}))+"</p>\n\n"+(null!=(o=c(t,"unless").call(i,null!=e?c(e,"isMinor"):e,{name:"unless",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:14,column:4},end:{line:17,column:15}}}))?o:"")},3:function(n,e,t,l,a){var o=null!=e?e:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t\t\t\t<p><button class='ui-button'><span>"+s((r(t,"intlMessage")||e&&r(e,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:a,loc:{start:{line:15,column:40},end:{line:15,column:111}}}))+"</span></button></p>\n\t\t\t\t\t<p>"+s((r(t,"intlHTMLMessage")||e&&r(e,"intlHTMLMessage")||i).call(o,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:a,loc:{start:{line:16,column:8},end:{line:16,column:88}}}))+"</p>\n"},5:function(n,e,t,l,a){var o,i=null!=e?e:n.nullContext||{},s=n.hooks.helperMissing,r=n.escapeExpression,c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t\t\t<p>"+r((c(t,"intlMessage")||e&&c(e,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:a,loc:{start:{line:19,column:7},end:{line:19,column:74}}}))+' <a href="//'+r("function"==typeof(o=null!=(o=c(t,"host")||(null!=e?c(e,"host"):e))?o:s)?o.call(i,{name:"host",hash:{},data:a,loc:{start:{line:19,column:86},end:{line:19,column:94}}}):o)+'/signin/" data-track="photoWellSignInClick">'+r((c(t,"intlMessage")||e&&c(e,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:a,loc:{start:{line:19,column:138},end:{line:19,column:179}}}))+"</a></p>\n"},7:function(n,e,t,l,a){var o,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\n"+(null!=(o=i(t,"if").call(null!=e?e:n.nullContext||{},null!=e?i(e,"isVideo"):e,{name:"if",hash:{},fn:n.program(8,a,0),inverse:n.program(11,a,0),data:a,loc:{start:{line:25,column:1},end:{line:46,column:8}}}))?o:"")},8:function(n,e,t,l,a){var o,i,s=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,c="function",p=n.escapeExpression,u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<div class="videoplayer main-image-wrapper">\n\t\t\t<video id="video_1" poster="'+p(typeof(i=null!=(i=u(t,"url")||(null!=e?u(e,"url"):e))?i:r)===c?i.call(s,{name:"url",hash:{},data:a,loc:{start:{line:27,column:31},end:{line:27,column:38}}}):i)+'" class="video-js vjs-big-play-centered inherit-size main-image" style="'+(null!=(o=u(t,"if").call(s,null!=e?u(e,"isServer"):e,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:27,column:110},end:{line:27,column:145}}}))?o:"")+" max-width: 100%; max-height: "+p(typeof(i=null!=(i=u(t,"maxHeight")||(null!=e?u(e,"maxHeight"):e))?i:r)===c?i.call(s,{name:"maxHeight",hash:{},data:a,loc:{start:{line:27,column:175},end:{line:27,column:188}}}):i)+'px;"></video>\n\t\t</div>\n'},9:function(n,e,t,l,a){return"width: 100%;"},11:function(n,e,t,l,a){var o,i,s=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,c="function",p=n.escapeExpression,u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<div class="main-image-wrapper" '+(null!=(o=u(t,"if").call(s,null!=e?u(e,"isServer"):e,{name:"if",hash:{},fn:n.program(12,a,0),inverse:n.noop,data:a,loc:{start:{line:30,column:34},end:{line:30,column:94}}}))?o:"")+'>\n\t\t\t<img class="main-image img" style="'+(null!=(o=u(t,"if").call(s,null!=e?u(e,"isServer"):e,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:31,column:38},end:{line:31,column:73}}}))?o:"")+' max-width: 100%;" src="'+p(typeof(i=null!=(i=u(t,"url")||(null!=e?u(e,"url"):e))?i:r)===c?i.call(s,{name:"url",hash:{},data:a,loc:{start:{line:31,column:97},end:{line:31,column:104}}}):i)+'"/>\n\t\t\t<script nonce="'+p(typeof(i=null!=(i=u(t,"cspNonce")||(null!=e?u(e,"cspNonce"):e))?i:r)===c?i.call(s,{name:"cspNonce",hash:{},data:a,loc:{start:{line:32,column:18},end:{line:32,column:30}}}):i)+'">\n\t\t\tvar img = document.querySelector(\'.mobile-photo-well-view .main-image\');\n\t\t\timg.onload = function () { registerFirstPhoto(img); };\n\t\t\t<\/script>\n\t\t</div>\n\t\t<div class="main-image-wrapper-underlay"></div>\n\t\t<script nonce="'+p(typeof(i=null!=(i=u(t,"cspNonce")||(null!=e?u(e,"cspNonce"):e))?i:r)===c?i.call(s,{name:"cspNonce",hash:{},data:a,loc:{start:{line:38,column:17},end:{line:38,column:29}}}):i)+'">\n\t\tvar windowWidth = window.innerWidth;\n\t\tvar aspect = '+p(typeof(i=null!=(i=u(t,"loadAspect")||(null!=e?u(e,"loadAspect"):e))?i:r)===c?i.call(s,{name:"loadAspect",hash:{},data:a,loc:{start:{line:40,column:15},end:{line:40,column:29}}}):i)+";\n\n\t\tif (aspect) {\n\t\t\tdocument.getElementsByClassName('main-image')[0].style.height = (windowWidth * aspect) + 'px';\n\t\t}\n\t\t<\/script>\n"},12:function(n,e,t,l,a){var o,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'style="max-height: '+n.escapeExpression("function"==typeof(o=null!=(o=i(t,"loadHeight")||(null!=e?i(e,"loadHeight"):e))?o:n.hooks.helperMissing)?o.call(null!=e?e:n.nullContext||{},{name:"loadHeight",hash:{},data:a,loc:{start:{line:30,column:69},end:{line:30,column:83}}}):o)+'px;"'},compiler:[8,">= 4.3.0"],main:function(n,e,t,l,a){var o,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<a class="loading hide-nav-link prev-photo photo-link" href="#">\n\t<div class="arrow-overlay arrow-left">\n\t\t<svg class="tiny icon icon-nav_left prev-photo-icon"><use xlink:href="#icon-nav_left"></use></svg>\n\t</div>\n</a>\n\n'+(null!=(o=i(t,"if").call(null!=e?e:n.nullContext||{},null!=e?i(e,"needsInterstitial"):e,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.program(7,a,0),data:a,loc:{start:{line:7,column:0},end:{line:47,column:7}}}))?o:"")+'\n<a class="loading hide-nav-link next-photo photo-link" href="#">\n\t<div class="arrow-overlay arrow-right">\n\t\t<svg class="tiny icon icon-nav_right next-photo-icon"><use xlink:href="#icon-nav_right"></use></svg>\n\t</div>\n</a>\n'},useData:!0}),l={};n.Array.each([],(function(e){var t=n.Template.get("hermes/"+e);t&&(l[e]=t)})),n.Template.register("hermes/mobile-photo-well",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(l,a.partials):l,t(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});