"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86337],{86337:function(e,t,i){i.d(t,{VL:function(){return Q}});var n,o=i(10253),s=i(85893),r=i(5152),a=i.n(r),c=i(67294),l=i(40069),d=i(55840),u=i(72957),p=i(87266),f=i(25784),g=i(9439),m=i(47568),C=i(14924),v=i(26042),T=i(70655),S=i(40821),I=i(85672),y=i(331),h=i(70056),A=i(29336),w=i(86109),b=i(98462),P=i(49071),_=i(39224),Z=i(56527),k=i(80930),O=i(48497),D=i(33340),M=i(75957),x=i(14587),U=i(24773),E=function(e){var t=e.queryParams;return(0,I.nS)({queryParams:t}).formattedUrl},R=function(e){var t=e.assetId,i=e.asset,n=i.id,o=i.tier,s=i.src,r=i.aspect,a=i.width,c=i.height;return{metadata:{notes:{media_id:t,alpha_num_id:n,rex_id:n,media_type:h.gP,tier:void 0===o?10:o,media:{aspect:r,width:a,height:c,url:s}}}}},J=(n=(0,m.Z)(function(e){var t,i,n,o,s,r,a,c,l,d,p,f,g;return(0,T.__generator)(this,function(m){switch(m.label){case 0:if(t=e.isRexEditorial,i=e.collectionId,n=e.verificationCode,o=e.setAsCover,s=e.firstAsset,r=e.collectionType,(c=(0,u.A8)(s))!==h.VT)return[2];return l={id:i,verificationCode:n,collectionType:r},d=(0,I.Yz)({queryParams:l}).formattedUrl,[4,M.uS.get(d).then(function(e){return(0,x.O)(e.data)||{}})];case 1:if(null==(p=m.sent())?void 0:null===(a=p.coverItem)||void 0===a?void 0:a.id)return[3,3];return f=(0,u.OP)({asset:s,isRexEditorial:t}),g=(0,P.Q)({collectionId:i,mappedAssetType:c,assetId:f}),[4,o({collection:{id:i},mediaItem:{id:g}})];case 2:m.sent(),m.label=3;case 3:return[2]}})}),function(e){return n.apply(this,arguments)}),N=function(){var e,t=(0,o.Z)((0,c.useState)({status:"",error:void 0}),2),i=t[0],n=t[1],s=(0,o.Z)((0,c.useState)(""),2),r=s[0],a=s[1],l=(0,o.Z)((0,c.useState)(""),2),d=l[0],p=l[1],f=(0,k.J)(),g=(0,U.w)().setAsCover,x=(0,O.D)().isBrandSstk,N=(0,D.yh)().analytics,B=(0,b.UM)(N);return{add:(0,c.useCallback)((e=(0,m.Z)(function(e){var t,i,o,s,r,c,l,d,m,b,k,O,D,U,N,j,V,q,G,L,H,z,Q;return(0,T.__generator)(this,function(T){switch(T.label){case 0:t=e.assets,i=e.assetType,o=e.gridItems,s=e.groupedOptions,r=e.id,c=e.title,l=e.verificationCode,d=e.pageSection,m=e.listId,b=(0,_.wZ)({assetType:i,isBrandSstk:x}),T.label=1;case 1:if(T.trys.push([1,6,7,9]),n({status:y.MR,error:void 0}),k=(0,u.Xo)(i),O=r,D=l,s&&s.length&&(U=s.find(function(e){return e.title===c}))&&(O=U.id,D=U.verificationCode),O)return[3,3];return N=(0,I.A6)().formattedUrl,j={data:{attributes:{title:c,collectionType:b,isPublic:!1},type:A.Ul}},[4,M.uS.post(N,j)];case 2:q=(V=T.sent().data).id,G=V.attributes.verificationCode,O=q,D=G,T.label=3;case 3:return L={data:t.map(function(e){var t=(0,u.OP)({asset:e,isRexEditorial:k}),i=(0,u.A8)(e);return(0,v.Z)({type:A.A8,id:(0,P.Q)({collectionId:O,mappedAssetType:i,assetId:t})},i===h.VT&&R({assetId:t,asset:e}))})},H=(0,I.mp)({urlParams:{id:O},queryParams:{isRexEditorial:k}}).formattedUrl,z=(0,Z.y)(B),[4,M.uS.post(H,L,z?{headers:(0,C.Z)({},w.as,z)}:void 0)];case 4:return T.sent(),[4,J({isRexEditorial:k,collectionId:O,verificationCode:D,setAsCover:g,firstAsset:t[0],collectionType:b})];case 5:return T.sent(),f({collectionId:O,collectionName:c,gridItems:o,assets:t,pageSection:d,listId:m}),a(O),p(D),[3,9];case 6:return Q=T.sent(),n({status:y.cM,error:Q}),[3,9];case 7:return[4,(0,S.JG)(E({queryParams:{"filter[type]":b}}))];case 8:return T.sent(),[7];case 9:return[2]}})}),function(t){return e.apply(this,arguments)}),[f,g,B,x]),collectionId:r,setStatus:n,status:i,verificationCode:d}},B=i(19805),j=i(66978),V=i(99534),q=a()(function(){return Promise.all([i.e(39293),i.e(85694),i.e(41664),i.e(15949),i.e(58499),i.e(30077),i.e(63237),i.e(51773)]).then(i.bind(i,11703)).then(function(e){return e.CollectionModal})},{loadableGenerated:{webpack:function(){return[11703]}},ssr:!1}),G=function(e){var t=e.isOpen,i=(0,V.Z)(e,["isOpen"]);return(0,g.B)(t)&&(0,s.jsx)(q,(0,v.Z)({isOpen:t},i))},L=a()(function(){return i.e(73978).then(i.bind(i,73978)).then(function(e){return e.LazyAddToCollectionModal})},{loadableGenerated:{webpack:function(){return[73978]}},ssr:!1}),H=a()(function(){return i.e(49303).then(i.bind(i,49303)).then(function(e){return e.Snackbar})},{loadableGenerated:{webpack:function(){return[49303]}},ssr:!1}),z=function(e){var t=e.assets,i=e.assetType,n=e.collectionId,o=e.collectionTitle,r=e.gridItems,a=e.isDialogActive,d=e.isSnackBarOpen,u=e.onAddToCollections,p=e.onAlertSnackbarClose,f=e.onAddToCollectionsComplete,m=e.redirectToCDPAction,C=e.setIsDialogActive,v=e.showCopyToModalTitle,T=e.status,S=e.verificationCode,I=e.pageSection,y=(0,j.p)(l.vb),h=(0,j.p)(l.pG),A=(0,g.B)(t),w=(0,c.useCallback)(function(){return C(!1)},[C]);return A?y||h?(0,s.jsx)(L,{onClose:w,isOpen:a,items:t,onAddToCollectionsComplete:f,pageSection:I}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(G,{assets:t,assetType:i,collectionId:n,gridItems:r,isOpen:a,onAddToCollections:u,setIsDialogActive:C,showCopyToModalTitle:v,pageSection:I}),(0,s.jsx)(H,{assetType:i,collectionId:n,collectionTitle:o,isOpen:d,onAlertSnackbarClose:p,redirectToCDPAction:m,status:T,verificationCode:S})]}):null};z.defaultProps={assetType:"",assets:null,gridItems:null,onAddToCollectionsComplete:void 0,redirectToCDPAction:{}};var Q=function(e){var t=e.initialAssetType,i=(0,o.Z)((0,c.useState)(!1),2),n=i[0],s=i[1],r=(0,o.Z)((0,c.useState)(!1),2),a=r[0],l=r[1],g=(0,o.Z)((0,c.useState)(!1),2),m=g[0],C=g[1],v=(0,o.Z)((0,c.useState)(""),2),T=v[0],S=v[1],I=(0,o.Z)((0,c.useState)(null),2),y=I[0],h=I[1],A=(0,o.Z)((0,c.useState)(t),2),w=A[0],b=A[1],P=(0,o.Z)((0,c.useState)(null),2),_=P[0],Z=P[1],k=(0,o.Z)((0,c.useState)(null),2),O=k[0],D=k[1],M=(0,o.Z)((0,c.useState)(null),2),x=M[0],U=M[1],E=(0,B.B)(),R=(0,p.cM)(),J=(0,f.L)(),j=(0,o.Z)((0,c.useState)({shouldHandleRedirect:!1,redirectToCollectionDetailsPage:J}),2),V=j[0],q=j[1],G=N(),L=G.add,H=G.status,Q=G.collectionId,Y=G.verificationCode;(0,c.useEffect)(function(){return function(){return h(null)}},[]),(0,c.useEffect)(function(){return function(){return b("")}},[]);var F=(0,c.useCallback)(function(e){var t=e.formattedAssets,i=e.gridItems,n=e.isCopyToCollection,o=e.mappedAssetType,r=e.redirectToCollectionDetailsPage,a=e.pageSection,c=e.listId;b(o),h(t),D(a),U(c),n&&C(!0),i&&Z(i),r&&q({shouldHandleRedirect:!0,redirectToCollectionDetailsPage:r}),s(!0)},[]);return(0,c.useEffect)(function(){(0,d.DZ)({showAddToCollectionModal:F,isLoggedInUser:E})},[E,F]),{addToCollectionViewsProps:(0,c.useMemo)(function(){return{assets:y,pageSection:O,assetType:w,collectionId:Q,collectionTitle:T,gridItems:_,isDialogActive:n,isSnackBarOpen:a,onAddToCollections:function(e){var t=e.id,i=e.title,n=e.verificationCode,o=e.groupedOptions,r=e.pageSection;return S(i),s(!1),l(!0),L({assetType:w,assets:y,gridItems:_,groupedOptions:o,id:t,title:i,verificationCode:n,pageSection:r||O,listId:x})},onAlertSnackbarClose:function(){return l(!1)},redirectToCDPAction:V,setIsDialogActive:s,showCopyToModalTitle:m,status:H,verificationCode:Y}},[y,_,L,x,O,w,Q,T,n,a,V,m,H,Y]),addToCollectionViewsHandler:(0,c.useCallback)(function(e){var t=e.assets,i=e.gridItems,n=e.isCopyToCollection,o=e.redirectToCollectionDetailsPage,s=e.pageSection,r=e.listId;if(E){var a=[].concat(t);F({formattedAssets:a,gridItems:i,isCopyToCollection:void 0!==n&&n,mappedAssetType:(0,u.A8)(a[0]),redirectToCollectionDetailsPage:o,pageSection:s,listId:r})}else(0,d.JO)({assets:t,gridItems:i,signUpPath:R})},[E,F,R]),AddToCollectionViews:z}}},55840:function(e,t,i){i.d(t,{DZ:function(){return a},JO:function(){return r}});var n=i(72957),o="add_to_collection_asset",s="add_to_collection_grid_items",r=function(e){var t=e.assets,i=e.gridItems,n=e.signUpPath;window&&(t&&window.sessionStorage.setItem(o,JSON.stringify(t)),i&&window.sessionStorage.setItem(s,JSON.stringify(i)),window.location=n)},a=function(e){var t=e.showAddToCollectionModal,i=e.isLoggedInUser;if(void 0!==i){if(i){var r=window.sessionStorage.getItem(o),a=window.sessionStorage.getItem(s),c=function(e){return e&&"undefined"!==e};if(c(r)&&c(a)){var l=JSON.parse(r),d=JSON.parse(a),u=[].concat(l);t({formattedAssets:u,gridItems:d,mappedAssetType:(0,n.A8)(u[0]),isCopyToCollection:!1,redirectToCollectionDetailsPage:!1})}}window.sessionStorage.removeItem(o),window.sessionStorage.removeItem(s)}}},56527:function(e,t,i){i.d(t,{y:function(){return n}});var n=function(e){return[e.subPage,e.pageType].join("-")}},80930:function(e,t,i){i.d(t,{J:function(){return a}});var n=i(67294),o=i(98462),s=i(33340),r=i(84977),a=function(){var e=(0,s.yh)().analytics,t=(0,r.Y)().getSearchContext;return(0,n.useCallback)(function(i){var n=i.collectionId,s=i.collectionName,r=i.gridItems,a=i.assets,c=i.pageSection,l=i.listId;e.productAddedToWishlist({products:a.map(function(e){return(0,o.bR)({asset:e,getSearchContext:t,gridItems:r,pageSection:c})}),wishlist_id:n,wishlist_name:s,list_id:null!=l?l:""})},[e,t])}},24773:function(e,t,i){i.d(t,{w:function(){return u}});var n=i(47568),o=i(10253),s=i(70655),r=i(67294),a=i(85672),c=i(331),l=i(29336),d=i(75957),u=function(){var e,t=(0,o.Z)((0,r.useState)({status:"",error:void 0}),2),i=t[0],u=t[1],p=(0,r.useCallback)((e=(0,n.Z)(function(e){var t,i,n,o,r;return(0,s.__generator)(this,function(s){switch(s.label){case 0:t=e.collection,i=e.mediaItem,n=(0,a.df)({urlParams:{id:t.id}}).formattedUrl,o={data:{id:t.id,relationships:{"cover-item":{data:{id:"".concat(i.id),type:l.A8}}},type:l.Ul}},s.label=1;case 1:return s.trys.push([1,3,,4]),u({status:c.MR,error:void 0}),[4,d.uS.patch(n,o)];case 2:return s.sent(),[3,4];case 3:return r=s.sent(),u({status:c.cM,error:r}),[3,4];case 4:return[2]}})}),function(t){return e.apply(this,arguments)}),[]);return{status:i,setStatus:u,setAsCover:p}}}}]);
//# sourceMappingURL=86337-d7cb6fce362a33c7.js.map